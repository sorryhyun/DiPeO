# Naming Convention Audit Report

**Date**: 2025-10-09
**Task**: #7 - Standardize naming conventions
**Goal**: Achieve 100% naming consistency by standardizing all field names to snake_case

## Executive Summary

This audit identified **11 total field names** across **3 node specifications** that use camelCase and need to be converted to snake_case. The majority of the codebase (13 out of 16 node specs) already follows snake_case conventions correctly.

## Audit Findings

### Files with camelCase Field Names

#### 1. code-job.spec.ts (2 fields)
- `filePath` → `file_path`
  - Line 35-43
  - Description: "Path to code file"
  - Required: false
  - Type: string

- `functionName` → `function_name`
  - Line 56-63
  - Description: "Function to execute"
  - Required: false
  - Type: string

#### 2. sub-diagram.spec.ts (1 field)
- `ignoreIfSub` → `ignore_if_sub`
  - Line 94-102
  - Description: "Skip execution if this diagram is being run as a sub-diagram"
  - Required: false
  - Type: boolean
  - Default: false

#### 3. typescript-ast.spec.ts (8 fields)
- `extractPatterns` → `extract_patterns`
  - Line 29-41
  - Description: "Patterns to extract from the AST"
  - Required: false
  - Type: array
  - Default: [TypeScriptExtractPattern.INTERFACE, TypeScriptExtractPattern.TYPE, TypeScriptExtractPattern.ENUM]

- `includeJSDoc` → `include_jsdoc`
  - Line 43-51
  - Description: "Include JSDoc comments in the extracted data"
  - Required: false
  - Type: boolean
  - Default: false

- `parseMode` → `parse_mode`
  - Line 53-68
  - Description: "TypeScript parsing mode"
  - Required: false
  - Type: enum
  - Default: TypeScriptParseMode.MODULE

- `transformEnums` → `transform_enums`
  - Line 70-78
  - Description: "Transform enum definitions to a simpler format"
  - Required: false
  - Type: boolean
  - Default: false

- `flattenOutput` → `flatten_output`
  - Line 80-88
  - Description: "Flatten the output structure for easier consumption"
  - Required: false
  - Type: boolean
  - Default: false

- `outputFormat` → `output_format`
  - Line 90-106
  - Description: "Output format for the parsed data"
  - Required: false
  - Type: enum
  - Default: TypeScriptOutputFormat.STANDARD

- `batchInputKey` → `batch_input_key`
  - Line 118-126
  - Description: "Key to extract batch items from input"
  - Required: false
  - Type: string
  - Default: "sources"

### Files Already Using snake_case (Compliant)

The following node specifications already use snake_case consistently:
1. api-job.spec.ts ✓
2. condition.spec.ts ✓
3. db.spec.ts ✓
4. diff-patch.spec.ts ✓
5. endpoint.spec.ts ✓
6. hook.spec.ts ✓
7. integrated-api.spec.ts ✓
8. ir-builder.spec.ts ✓
9. json-schema-validator.spec.ts ✓
10. person-job.spec.ts ✓
11. start.spec.ts ✓
12. template-job.spec.ts ✓
13. user-response.spec.ts ✓

## Files Requiring Updates

### 1. Node Specification Files (3 files)
- `/dipeo/models/src/nodes/code-job.spec.ts`
- `/dipeo/models/src/nodes/sub-diagram.spec.ts`
- `/dipeo/models/src/nodes/typescript-ast.spec.ts`

### 2. Codegen Configuration Files (1 file)
- `/dipeo/models/src/codegen/mappings.ts`
  - Update `FIELD_SPECIAL_HANDLING.typescript_ast` object:
    - `extractPatterns` → `extract_patterns`
    - `includeJSDoc` → `include_jsdoc`
    - `parseMode` → `parse_mode`

### 3. Generated Files (auto-regenerated)
- `/dipeo/models/src/__generated__/schemas.ts` (will be regenerated by codegen)
- `/apps/web/src/__generated__/` (will be regenerated by codegen)

### 4. Files NOT Requiring Updates
- `/dipeo/models/src/claude-code/session-types.ts`
  - Contains `DiffPatchInput.filePath` which is unrelated to node specs
  - This is a separate concern for Claude Code session types

## Impact Analysis

### Breaking Changes
This change is **backward incompatible** and will affect:
- Existing diagram files using these fields
- Any Python/TypeScript code referencing these field names
- GraphQL queries using these fields

### Migration Path
1. Update TypeScript specs (source of truth)
2. Run codegen to regenerate Python models
3. Update GraphQL schema
4. Update any existing diagrams to use new field names
5. Update any custom code referencing these fields

## Recommendations

### Immediate Actions
1. ✓ Complete audit (DONE)
2. Update node specification files with snake_case field names
3. Update mappings.ts with correct field references
4. Build TypeScript to verify no compilation errors
5. Run codegen pipeline to regenerate Python code
6. Verify GraphQL schema generation
7. Test with example diagrams

### Documentation Updates Required
1. Update naming standards documentation
2. Add migration guide for existing diagrams
3. Document the snake_case convention as the standard

### Testing Strategy
1. TypeScript compilation check
2. Python type checking
3. GraphQL schema validation
4. Sample diagram execution
5. Verify no regression in existing functionality

## Naming Standards (To Be Documented)

### Field Naming Convention
- **Rule**: All field names MUST use snake_case
- **Examples**:
  - ✓ `file_path`, `function_name`, `extract_patterns`
  - ✗ `filePath`, `functionName`, `extractPatterns`

### Rationale
1. **Consistency**: Python backend uses snake_case convention
2. **Code Generation**: Simplifies TypeScript → Python mapping
3. **GraphQL**: Maintains consistent API surface
4. **Readability**: Clear separation between words
5. **Industry Standard**: Python PEP 8 compliance

## Next Steps

1. Proceed with field name updates in node specs
2. Update mappings.ts references
3. Build and verify TypeScript compilation
4. Run full codegen pipeline
5. Document naming standards
6. Create migration guide for existing users

---

**Audit Completed By**: Claude Code TypeScript Model Design Agent
**Status**: Ready for implementation
