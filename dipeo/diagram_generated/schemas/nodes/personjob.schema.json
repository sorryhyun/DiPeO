{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$ref": "#/definitions/PersonJobNodeData",
  "definitions": {
    "PersonJobNodeData": {
      "additionalProperties": false,
      "description": "Configuration data for PersonJob nodes that execute LLM agents",
      "properties": {
        "at_most": {
          "type": "number"
        },
        "batch": {
          "description": "Enable batch processing for arrays",
          "type": "boolean"
        },
        "batch_input_key": {
          "description": "Array variable name for batch processing",
          "type": "string"
        },
        "batch_parallel": {
          "description": "Execute batch items in parallel",
          "type": "boolean"
        },
        "default_prompt": {
          "description": "Prompt template using {{variable}} syntax for subsequent iterations",
          "type": "string"
        },
        "first_only_prompt": {
          "description": "Special prompt for first iteration only, supports {{variable}} syntax",
          "type": "string"
        },
        "first_prompt_file": {
          "description": "External prompt file for first iteration only (overrides first_only_prompt)",
          "type": "string"
        },
        "flipped": {
          "type": "boolean"
        },
        "label": {
          "type": "string"
        },
        "max_concurrent": {
          "description": "Maximum concurrent batch executions",
          "type": "number"
        },
        "max_iteration": {
          "description": "Maximum conversation turns (default: 1)",
          "type": "number"
        },
        "memorize_to": {
          "type": "string"
        },
        "person": {
          "$ref": "#/definitions/PersonID",
          "description": "Reference to agent defined in 'persons' section"
        },
        "prompt_file": {
          "description": "External prompt file in files/prompts/ (overrides inline prompts)",
          "type": "string"
        },
        "text_format": {
          "description": "Pydantic model name for structured output",
          "type": "string"
        },
        "text_format_file": {
          "description": "External Python file with Pydantic models (overrides text_format)",
          "type": "string"
        },
        "tools": {
          "description": "LLM tools to enable (web_search_preview, etc.)",
          "enum": [
            "image",
            "none",
            "websearch"
          ],
          "type": "string"
        }
      },
      "required": [
        "at_most",
        "first_only_prompt",
        "label",
        "max_iteration",
        "memorize_to"
      ],
      "type": "object"
    },
    "PersonID": {
      "additionalProperties": false,
      "properties": {
        "__brand": {
          "const": "PersonID",
          "type": "string"
        }
      },
      "required": [
        "__brand"
      ],
      "type": "object"
    }
  }
}