{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$ref": "#/definitions/TemplateJobNodeData",
  "definitions": {
    "TemplateJobNodeData": {
      "additionalProperties": false,
      "properties": {
        "engine": {
          "enum": [
            "internal",
            "jinja2"
          ],
          "type": "string"
        },
        "flipped": {
          "type": "boolean"
        },
        "foreach": {
          "additionalProperties": false,
          "description": "Render a template for each item and write many files",
          "properties": {
            "as": {
              "description": "Variable name to expose each item under in the template (default: \"item\")",
              "type": "string"
            },
            "items": {
              "anyOf": [
                {
                  "items": {},
                  "type": "array"
                },
                {
                  "type": "string"
                }
              ],
              "description": "Array or dotted-path string to an array in inputs"
            },
            "limit": {
              "description": "Optional: limit, parallel write hint (ignored in v1)",
              "type": "number"
            },
            "output_path": {
              "description": "File path template, e.g. \"dipeo/diagram_generated_staged/models/{{ item.nodeTypeSnake }}.py\"",
              "type": "string"
            }
          },
          "required": [
            "items",
            "output_path"
          ],
          "type": "object"
        },
        "label": {
          "type": "string"
        },
        "output_path": {
          "description": "Single-file path; can contain template expressions",
          "type": "string"
        },
        "preprocessor": {
          "additionalProperties": false,
          "description": "Optional Python preprocessor that returns extra context for the template",
          "properties": {
            "args": {
              "$ref": "#/definitions/JsonDict"
            },
            "function": {
              "type": "string"
            },
            "module": {
              "type": "string"
            }
          },
          "required": [
            "function",
            "module"
          ],
          "type": "object"
        },
        "template_content": {
          "type": "string"
        },
        "template_path": {
          "type": "string"
        },
        "variables": {
          "$ref": "#/definitions/JsonDict",
          "description": "Simple key\u2192value map passed to template; string values are resolved"
        }
      },
      "required": [
        "label"
      ],
      "type": "object"
    },
    "JsonDict": {
      "additionalProperties": false,
      "type": "object"
    }
  }
}