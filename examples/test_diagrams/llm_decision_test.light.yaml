version: light

persons:
  Validator:
    service: openai
    model: gpt-5-nano-2025-08-07
    api_key_id: APIKEY_52609F

nodes:
  - label: Start
    type: start
    position: {x: 100, y: 200}
    props:
      trigger_mode: manual
      custom_data:
        generated_output: |
          def process_data(input_data):
              """Process the input data and return results."""
              result = []
              for item in input_data:
                  if item.get('valid'):
                      processed = {
                          'id': item['id'],
                          'value': item['value'] * 2,
                          'timestamp': datetime.now()
                      }
                      result.append(processed)
              return result

  - label: Check Output Quality
    type: condition
    position: {x: 400, y: 200}
    props:
      condition_type: llm_decision
      person: Validator
      memorize_to: "GOLDFISH"  # Fresh evaluation each time
      judge_by: |
        Review this generated code output and determine if it's acceptable.
        
        Output to review:
        {{generated_output}}
        
        Respond with only YES or NO:
        - YES if the output contains actual code implementation (even if imperfect)
        - NO if the output is severely flawed (e.g., contains explanatory text instead of code, is empty, or completely unusable)
        
        Decision:

  - label: Good Output
    type: endpoint
    position: {x: 600, y: 100}
    props:
      file_format: txt
      save_to_file: true
      file_path: files/results/good_output.txt

  - label: Bad Output
    type: endpoint
    position: {x: 600, y: 300}
    props:
      file_format: txt
      save_to_file: true
      file_path: files/results/bad_output.txt

connections:
  - {from: Start, to: Check Output Quality, label: generated_output}
  - {from: Check Output Quality_condtrue, to: Good Output, label: output}
  - {from: Check Output Quality_condfalse, to: Bad Output, label: output}