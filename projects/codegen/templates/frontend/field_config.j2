// Generated field configuration for {{ nodeType }}
import type { UnifiedFieldDefinition } from '@/infrastructure/config/unifiedConfig';

export const {{ nodeType | camel_case }}Fields: UnifiedFieldDefinition[] = [
{%- for field in fields %}
  {
    name: '{{ field['name'] }}',
    type: '{{ field | ui_field_type }}',
    label: '{{ field['name'] | humanize | escape_js }}',
    required: {{ field.get('required', false) | lower }},
{%- if field.get('defaultValue') is defined %}
    defaultValue: {{ field['defaultValue'] | tojson }},
{%- endif %}
{%- if field.get('uiConfig') and field['uiConfig'].get('placeholder') %}
    placeholder: '{{ field['uiConfig']['placeholder'] | escape_js }}',
{%- elif field.get('placeholder') %}
    placeholder: '{{ field['placeholder'] | escape_js }}',
{%- endif %}
{%- if field.get('description') %}
    description: '{{ field['description'] | escape_js }}',
{%- endif %}
{%- if field.get('type') == 'enum' and field.get('values') %}
    options: [
{%- for value in field['values'] %}
      { value: '{{ value | escape_js }}', label: '{{ value | humanize | escape_js }}' },
{%- endfor %}
    ],
{%- endif %}
{%- if field.get('uiConfig') %}
{%- if field['uiConfig'].get('rows') %}
    rows: {{ field['uiConfig']['rows'] }},
{%- endif %}
{%- if field['uiConfig'].get('column') %}
    column: {{ field['uiConfig']['column'] }},
{%- endif %}
{%- if field['uiConfig'].get('min') is defined %}
    min: {{ field['uiConfig']['min'] }},
{%- endif %}
{%- if field['uiConfig'].get('max') is defined %}
    max: {{ field['uiConfig']['max'] }},
{%- endif %}
{%- if field['uiConfig'].get('language') %}
    language: '{{ field['uiConfig']['language'] }}',
{%- endif %}
{%- if field['uiConfig'].get('readOnly') %}
    readOnly: {{ field['uiConfig']['readOnly'] | lower }},
{%- endif %}
{%- if field['uiConfig'].get('adjustable') %}
    adjustable: {{ field['uiConfig']['adjustable'] | lower }},
{%- endif %}
{%- if field['uiConfig'].get('showPromptFileButton') %}
    showPromptFileButton: {{ field['uiConfig']['showPromptFileButton'] | lower }},
{%- endif %}
{%- if field['uiConfig'].get('options') %}
    options: [
{%- for option in field['uiConfig']['options'] %}
      { value: '{{ option['value'] | escape_js }}', label: '{{ option['label'] | escape_js }}' },
{%- endfor %}
    ],
{%- endif %}
{%- endif %}
{%- if field.get('nestedFields') %}
    nestedFields: [
{%- for nestedField in field['nestedFields'] %}
      {
        name: '{{ nestedField['name'] }}',
        type: '{{ nestedField | ui_field_type }}',
        label: '{{ nestedField['name'] | humanize | escape_js }}',
        required: {{ nestedField.get('required', false) | lower }},
{%- if nestedField.get('description') %}
        description: '{{ nestedField['description'] | escape_js }}',
{%- endif %}
{%- if nestedField.get('defaultValue') is defined %}
        defaultValue: {{ nestedField['defaultValue'] | tojson }},
{%- endif %}
{%- if nestedField.get('uiConfig') %}
        uiConfig: {
{%- if nestedField['uiConfig'].get('inputType') %}
          inputType: '{{ nestedField['uiConfig']['inputType'] }}',
{%- endif %}
{%- if nestedField['uiConfig'].get('options') %}
          options: [
{%- for option in nestedField['uiConfig']['options'] %}
            { value: '{{ option['value'] | escape_js }}', label: '{{ option['label'] | escape_js }}' },
{%- endfor %}
          ],
{%- endif %}
{%- if nestedField['uiConfig'].get('min') is defined %}
          min: {{ nestedField['uiConfig']['min'] }},
{%- endif %}
{%- if nestedField['uiConfig'].get('max') is defined %}
          max: {{ nestedField['uiConfig']['max'] }},
{%- endif %}
{%- if nestedField['uiConfig'].get('placeholder') %}
          placeholder: '{{ nestedField['uiConfig']['placeholder'] | escape_js }}',
{%- endif %}
        },
{%- endif %}
      },
{%- endfor %}
    ],
{%- endif %}
{%- if field.get('validation') %}
    validate: (value: unknown) => {
{%- if field['validation'].get('pattern') %}
      if (typeof value === 'string' && !new RegExp('{{ field['validation']['pattern'] }}').test(value)) {
        return { isValid: false, error: 'Invalid format' };
      }
{%- endif %}
{%- if field['validation'].get('min') is defined %}
      if (typeof value === 'number' && value < {{ field['validation']['min'] }}) {
        return { isValid: false, error: 'Value must be at least {{ field['validation']['min'] }}' };
      }
{%- endif %}
{%- if field['validation'].get('max') is defined %}
      if (typeof value === 'number' && value > {{ field['validation']['max'] }}) {
        return { isValid: false, error: 'Value must be at most {{ field['validation']['max'] }}' };
      }
{%- endif %}
      return { isValid: true };
    },
{%- endif %}
  },
{%- endfor %}
];
