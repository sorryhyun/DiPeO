version: light
nodes:
- label: Start
  type: start
  position: {x: 100, y: 100}
  props:
    trigger_mode: manual
    custom_data:
      session_id: 0a8d9412-96ed-4095-b902-56dfbe7d51b6
      initial_prompt: '[{"type": "user", "message": {"role": "user", "content": [{"type": "text", "text": "CANDIDATE MESSAGES (id (sender): snippet):\n- 31a3f1 (system): say hi\n- 4b3ab9 (person 1): Hi!\n\n===\n\nTASK PREVI'
- label: Claude Responds To User 1
  type: person_job
  position: {x: 350, y: 100}
  props:
    person: claude_code
    default_prompt: '[{"type": "user", "message": {"role": "user", "content": [{"type": "text", "text": "CANDIDATE MESSAGES (id (sender): snippet):\n- 31a3f1 (system): say hi\n- 4b3ab9 (person 1): Hi!\n\n===\n\nTASK PREVIEW:\n===\n\nHow many times did you respond?\n\n===\n\nCRITERIA:\nALL_MESSAGES\n\nIMPORTANT: Exclude messages that duplicate content already in the task preview.\nReturn a JSON array of message IDs only."}]}}]'
- label: mcp__dipeo_structured_output__select_memory_messages 1
  type: api_job
  position: {x: 400, y: 100}
  props:
    endpoint: /tools/mcp__dipeo_structured_output__select_memory_messages
    method: POST
    body:
      message_ids:
      - 31a3f1
      - 4b3ab9
    timeout: 30
    description: mcp__dipeo_structured_output__select_memory_messages operation
- label: tool_result 2
  type: api_job
  position: {x: 450, y: 100}
  props:
    endpoint: /tools/tool_result
    method: POST
    body: {}
    timeout: 30
    description: tool_result operation
connections:
- {from: Start, to: Claude Responds To User 1, content_type: raw_text}
- {from: Claude Responds To User 1, to: mcp__dipeo_structured_output__select_memory_messages 1, content_type: raw_text}
- {from: mcp__dipeo_structured_output__select_memory_messages 1, to: tool_result 2, content_type: raw_text}
persons:
  claude_code:
    service: anthropic
    model: claude-code
    api_key_id: APIKEY_CLAUDE
    system_prompt: You are Claude Code, an AI assistant helping with software development.
metadata:
  conversion:
    total_nodes: 4
    total_connections: 3
    total_persons: 0
    node_types:
      start: 1
      person_job: 1
      api_job: 2
