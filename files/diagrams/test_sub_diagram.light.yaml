version: light
nodes:
  - label: Start
    type: start
    position: {x: 100, y: 200}
    props:
      trigger_mode: manual
      custom_data:
        test_input: "Hello from parent"
        
  - label: Run Sub Diagram
    type: sub_diagram
    position: {x: 400, y: 200}
    props:
      diagram_name: simple_sub
      input_mapping:
        initial_message: inputs.test_input
      output_mapping:
        result: default
      timeout: 30
      wait_for_completion: true
      
  - label: Process Result
    type: person_job
    position: {x: 700, y: 200}
    props:
      person: ResultProcessor
      default_prompt: |
        The sub-diagram returned: {{result}}
        
        Please summarize what happened.
      max_iteration: 1
      memory_profile: FULL
      
  - label: End
    type: endpoint
    position: {x: 1000, y: 200}
    props:
      save_to_file: true
      file_name: logs/test_sub_diagram_result.log

connections:
  - from: Start
    to: Run Sub Diagram
    content_type: object
    
  - from: Run Sub Diagram
    to: Process Result
    content_type: object
    
  - from: Process Result
    to: End
    content_type: raw_text

persons:
  ResultProcessor:
    service: openai
    model: gpt-4.1-nano
    api_key_id: APIKEY_52609F