version: light
nodes:
  - label: Start
    type: start
    position: {x: 100, y: 200}
    props:
      trigger_mode: manual
      custom_data:
        spec_path: ""  # Path to node specification JSON file
        
  - label: Read Spec File
    type: db
    position: {x: 300, y: 200}
    props:
      operation: read
      sub_type: file
      file: "{{spec_path}}"
      
  - label: Validate JSON Schema
    type: json_schema_validator
    position: {x: 500, y: 200}
    props:
      schema_path: files/codegen/schemas/node_specification.schema.json
      strict_mode: true
      error_on_extra: false
      
  - label: Parse and Normalize Spec
    type: code_job
    position: {x: 700, y: 200}
    props:
      functionName: normalize_spec_data
      code_type: python
      code: files/codegen/code/phase2/spec_ingestion_helpers.py
            
  - label: Add Metadata
    type: code_job
    position: {x: 900, y: 200}
    props:
      functionName: add_generation_metadata
      code_type: python
      code: files/codegen/code/phase2/spec_ingestion_helpers.py
            
  - label: End
    type: endpoint
    position: {x: 1100, y: 200}
    props:
      save_to_file: false

connections:
  - from: Start
    to: Read Spec File
    content_type: object
    
  - from: Read Spec File
    to: Validate JSON Schema
    content_type: raw_text
    
  - from: Validate JSON Schema
    to: Parse and Normalize Spec
    content_type: object
    label: validated_spec
    
  - from: Parse and Normalize Spec
    to: Add Metadata
    content_type: object
    
  - from: Start
    to: Add Metadata
    content_type: object
    label: spec_path
    
  - from: Add Metadata
    to: End
    content_type: object