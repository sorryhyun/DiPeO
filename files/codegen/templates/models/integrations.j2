"""
Integration-specific models and enums for DiPeO.
DO NOT EDIT - This file is automatically generated from integration.ts.
"""

from enum import Enum
from typing import Any, Dict, List, Optional, Union, TYPE_CHECKING
from pydantic import BaseModel, Field

# Import from other generated modules
from .enums import *

# Import TokenUsage for type hints
if TYPE_CHECKING:
    from .domain_models import TokenUsage, ToolOutput
else:
    # Forward references for runtime
    TokenUsage = 'TokenUsage'
    ToolOutput = 'ToolOutput'

{% if integration_data.enums %}
# Integration-specific enums
{% for enum in integration_data.enums %}
class {{ enum.name }}(str, Enum):
    """{{ enum.description or '' }}"""
    {% for value in enum['values'] %}
    {{ value.python_name }} = "{{ value.value }}"
    {% endfor %}

{% endfor %}
{% endif %}

{% if integration_data.interfaces %}
# Integration interfaces (converted to Pydantic models)
{% for interface in integration_data.interfaces %}
class {{ interface.name }}(BaseModel):
    """{{ interface.description or interface.name + ' model' }}"""
    {% for prop in interface.properties %}
    {%- set py_type = prop.type | ts_to_python -%}
    {%- set is_optional = prop.optional or ('undefined' in prop.type) -%}
    {%- if is_optional and not py_type.startswith('Optional[') %}
    {{ prop.name | snake_case }}: Optional[{{ py_type }}] = Field(default=None{% if prop.description %}, description={{ prop.description | tojson }}{% endif %})
    {%- elif is_optional %}
    {{ prop.name | snake_case }}: {{ py_type }} = Field(default=None{% if prop.description %}, description={{ prop.description | tojson }}{% endif %})
    {%- else %}
    {{ prop.name | snake_case }}: {{ py_type }}{% if prop.description %} = Field(description={{ prop.description | tojson }}){% endif %}
    {%- endif %}
    {% endfor %}

    class Config:
        extra = "forbid"
        validate_assignment = True

{% endfor %}
{% endif %}

# Export all integration types
__all__ = [
    # Re-exported from enums
    {% for import in integration_data.imports.from_enums %}
    "{{ import }}",
    {% endfor %}
    {% if integration_data.enums %}
    # Integration enums
    {% for enum in integration_data.enums %}
    "{{ enum.name }}",
    {% endfor %}
    {% endif %}
    {% if integration_data.interfaces %}
    # Integration interfaces
    {% for interface in integration_data.interfaces %}
    "{{ interface.name }}",
    {% endfor %}
    {% endif %}
]